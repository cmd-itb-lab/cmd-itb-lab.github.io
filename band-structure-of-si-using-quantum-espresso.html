<!DOCTYPE html>
<html lang="en">
<head>
        <meta charset="utf-8" />
        <title>Band structure of Si using Quantum ESPRESSO</title>
        <link rel="stylesheet" href="/theme/css/main.css" />
</head>

<body id="index" class="home">
        <header id="banner" class="body">
                <h1><a href="/">CMD ITB LAB </a></h1>
                <nav><ul>
                    <li><a href="/">Home</a></li>
                    <li><a href="/contact.html">Contact</a></li>
                    <li><a href="/members.html">Members</a></li>
                    <li><a href="/research-topics.html">Research</a></li>
                    <li><a href="/publications.html">Publications</a></li>
                    <li class="active"><a href="/category/post.html">Post</a></li>
                </ul></nav>
        </header><!-- /#banner -->
<section id="content" class="body">
  <article>
    <header>
      <h1 class="entry-title">
        <a href="/band-structure-of-si-using-quantum-espresso.html" rel="bookmark"
           title="Permalink to Band structure of Si using Quantum ESPRESSO">Band structure of Si using Quantum ESPRESSO</a></h1>
    </header>

    <div class="entry-content">
<footer class="post-info">
        <abbr class="published" title="2019-07-26T16:38:00+07:00">
                Published: Fri 26 July 2019
        </abbr>

        <address class="vcard author">
                By                         <a class="url fn" href="/author/cmd-itb-lab.html">cmd-itb-lab</a>
        </address>
<p>In <a href="/category/post.html">Post</a>.</p>

</footer><!-- /.post-info -->      <p>Quantum ESPRESSO version used in this tutorial: 6.4</p>
<p>Calculating band structure is one of typical task in electronic structure calculations.
In this tutorial, I will describe how to calculate band structure of silicon crystal
using density functional theory as implemented in PWSCF which is included in the
Quantum EPSRESSO package.</p>
<p>We will use the following steps.</p>
<p>(1) Running an SCF calculation to find the converged Kohn-Sham potential</p>
<p>(2) Running a band structure calculation. This is simply solving
    Schroedinger equation with the Kohn-Sham potential obtained from
    the previous SCF calculation.</p>
<p>(3) Extract the band structure data and plot the result. 
    In this tutorial, I will use Python (with Matplotlib)
    to create the plot.</p>
<p>Let's start with the SCF calculation.
Here is the input file.</p>
<div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">CONTROL</span>
  <span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;scf&#39;</span>
  <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;/home/efefer/pseudo&#39;</span>
  <span class="n">outdir</span> <span class="o">=</span> <span class="s1">&#39;./tmp&#39;</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="k">SYSTEM</span>
  <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">celldm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="p">.</span><span class="mi">20</span>
  <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mi">18</span><span class="p">.</span><span class="mi">0</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">ELECTRONS</span>
  <span class="n">mixing_beta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">7</span>
  <span class="n">conv_thr</span> <span class="o">=</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="n">d</span><span class="o">-</span><span class="mi">8</span>
<span class="o">/</span>

<span class="n">ATOMIC_SPECIES</span>
<span class="n">Si</span>  <span class="mi">28</span><span class="p">.</span><span class="mi">086</span>  <span class="n">Si</span><span class="p">.</span><span class="n">pz</span><span class="o">-</span><span class="n">vbc</span><span class="p">.</span><span class="n">UPF</span>

<span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span>
<span class="n">Si</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
<span class="n">Si</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span>

<span class="n">K_POINTS</span> <span class="n">automatic</span>
  <span class="mi">8</span> <span class="mi">8</span> <span class="mi">8</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span>
</pre></div>


<p>Let's name this file as <code>PWINPUT_scf</code> (you can use another name, of course).</p>
<p>Run this with the following command.</p>
<div class="highlight"><pre><span></span><span class="n">pw</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">PWINPUT_scf</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">LOG_scf</span>
</pre></div>


<p>This calculation should not take too much time.</p>
<p>Next, we will do the band calculation (in the same directory as the SCF calculation).</p>
<p>Here is the input file. Let's name it <code>PWINPUT_bands</code>.</p>
<div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">CONTROL</span>
  <span class="n">calculation</span> <span class="o">=</span> <span class="s1">&#39;bands&#39;</span>
  <span class="n">pseudo_dir</span> <span class="o">=</span> <span class="s1">&#39;/home/efefer/pseudo&#39;</span>
  <span class="n">outdir</span> <span class="o">=</span> <span class="s1">&#39;./tmp&#39;</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="k">SYSTEM</span>
  <span class="n">ibrav</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">celldm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="mi">10</span><span class="p">.</span><span class="mi">20</span>
  <span class="n">nat</span> <span class="o">=</span> <span class="mi">2</span>
  <span class="n">ntyp</span> <span class="o">=</span> <span class="mi">1</span>
  <span class="n">ecutwfc</span> <span class="o">=</span> <span class="mi">18</span><span class="p">.</span><span class="mi">0</span>
  <span class="n">nbnd</span> <span class="o">=</span> <span class="mi">8</span>
<span class="o">/</span>

<span class="o">&amp;</span><span class="n">ELECTRONS</span>
  <span class="n">mixing_beta</span> <span class="o">=</span> <span class="mi">0</span><span class="p">.</span><span class="mi">7</span>
  <span class="n">conv_thr</span> <span class="o">=</span>  <span class="mi">1</span><span class="p">.</span><span class="mi">0</span><span class="n">d</span><span class="o">-</span><span class="mi">8</span>
<span class="o">/</span>

<span class="n">ATOMIC_SPECIES</span>
<span class="n">Si</span>  <span class="mi">28</span><span class="p">.</span><span class="mi">086</span>  <span class="n">Si</span><span class="p">.</span><span class="n">pz</span><span class="o">-</span><span class="n">vbc</span><span class="p">.</span><span class="n">UPF</span>

<span class="n">ATOMIC_POSITIONS</span> <span class="n">crystal</span>
<span class="n">Si</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00</span>
<span class="n">Si</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25</span>

<span class="n">K_POINTS</span> <span class="n">crystal</span>
 <span class="mi">60</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">75000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">28125000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">71875000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15594042</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31250000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">68750000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31188083</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">34375000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">65625000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">46782125</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">37500000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">62500000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">62376166</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">40625000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">59375000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">77970208</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">43750000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">56250000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">93564249</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">46875000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">53125000</span> <span class="mi">1</span><span class="p">.</span><span class="mi">09158291</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">1</span><span class="p">.</span><span class="mi">24752332</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">47727273</span> <span class="mi">0</span><span class="p">.</span><span class="mi">47727273</span> <span class="mi">0</span><span class="p">.</span><span class="mi">47727273</span> <span class="mi">1</span><span class="p">.</span><span class="mi">38050976</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">45454545</span> <span class="mi">0</span><span class="p">.</span><span class="mi">45454545</span> <span class="mi">0</span><span class="p">.</span><span class="mi">45454545</span> <span class="mi">1</span><span class="p">.</span><span class="mi">51349619</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">43181818</span> <span class="mi">0</span><span class="p">.</span><span class="mi">43181818</span> <span class="mi">0</span><span class="p">.</span><span class="mi">43181818</span> <span class="mi">1</span><span class="p">.</span><span class="mi">64648262</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">40909091</span> <span class="mi">0</span><span class="p">.</span><span class="mi">40909091</span> <span class="mi">0</span><span class="p">.</span><span class="mi">40909091</span> <span class="mi">1</span><span class="p">.</span><span class="mi">77946905</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">38636364</span> <span class="mi">0</span><span class="p">.</span><span class="mi">38636364</span> <span class="mi">0</span><span class="p">.</span><span class="mi">38636364</span> <span class="mi">1</span><span class="p">.</span><span class="mi">91245549</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">36363636</span> <span class="mi">0</span><span class="p">.</span><span class="mi">36363636</span> <span class="mi">0</span><span class="p">.</span><span class="mi">36363636</span> <span class="mi">2</span><span class="p">.</span><span class="mi">04544192</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">34090909</span> <span class="mi">0</span><span class="p">.</span><span class="mi">34090909</span> <span class="mi">0</span><span class="p">.</span><span class="mi">34090909</span> <span class="mi">2</span><span class="p">.</span><span class="mi">17842835</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">31818182</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31818182</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31818182</span> <span class="mi">2</span><span class="p">.</span><span class="mi">31141479</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">29545455</span> <span class="mi">0</span><span class="p">.</span><span class="mi">29545455</span> <span class="mi">0</span><span class="p">.</span><span class="mi">29545455</span> <span class="mi">2</span><span class="p">.</span><span class="mi">44440122</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">27272727</span> <span class="mi">0</span><span class="p">.</span><span class="mi">27272727</span> <span class="mi">0</span><span class="p">.</span><span class="mi">27272727</span> <span class="mi">2</span><span class="p">.</span><span class="mi">57738765</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">25000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25000000</span> <span class="mi">2</span><span class="p">.</span><span class="mi">71037409</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">22727273</span> <span class="mi">0</span><span class="p">.</span><span class="mi">22727273</span> <span class="mi">0</span><span class="p">.</span><span class="mi">22727273</span> <span class="mi">2</span><span class="p">.</span><span class="mi">84336052</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">20454545</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20454545</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20454545</span> <span class="mi">2</span><span class="p">.</span><span class="mi">97634695</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">18181818</span> <span class="mi">0</span><span class="p">.</span><span class="mi">18181818</span> <span class="mi">0</span><span class="p">.</span><span class="mi">18181818</span> <span class="mi">3</span><span class="p">.</span><span class="mi">10933339</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">15909091</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15909091</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15909091</span> <span class="mi">3</span><span class="p">.</span><span class="mi">24231982</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">13636364</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13636364</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13636364</span> <span class="mi">3</span><span class="p">.</span><span class="mi">37530625</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">11363636</span> <span class="mi">0</span><span class="p">.</span><span class="mi">11363636</span> <span class="mi">0</span><span class="p">.</span><span class="mi">11363636</span> <span class="mi">3</span><span class="p">.</span><span class="mi">50829268</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">09090909</span> <span class="mi">0</span><span class="p">.</span><span class="mi">09090909</span> <span class="mi">0</span><span class="p">.</span><span class="mi">09090909</span> <span class="mi">3</span><span class="p">.</span><span class="mi">64127912</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">06818182</span> <span class="mi">0</span><span class="p">.</span><span class="mi">06818182</span> <span class="mi">0</span><span class="p">.</span><span class="mi">06818182</span> <span class="mi">3</span><span class="p">.</span><span class="mi">77426555</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">04545455</span> <span class="mi">0</span><span class="p">.</span><span class="mi">04545455</span> <span class="mi">0</span><span class="p">.</span><span class="mi">04545455</span> <span class="mi">3</span><span class="p">.</span><span class="mi">90725198</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">02272727</span> <span class="mi">0</span><span class="p">.</span><span class="mi">02272727</span> <span class="mi">0</span><span class="p">.</span><span class="mi">02272727</span> <span class="mi">4</span><span class="p">.</span><span class="mi">04023842</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">4</span><span class="p">.</span><span class="mi">17322485</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">02631579</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">02631579</span> <span class="mi">4</span><span class="p">.</span><span class="mi">30454309</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">05263158</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">05263158</span> <span class="mi">4</span><span class="p">.</span><span class="mi">43586134</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">07894737</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">07894737</span> <span class="mi">4</span><span class="p">.</span><span class="mi">56717958</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">10526316</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">10526316</span> <span class="mi">4</span><span class="p">.</span><span class="mi">69849783</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">13157895</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">13157895</span> <span class="mi">4</span><span class="p">.</span><span class="mi">82981607</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">15789474</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">15789474</span> <span class="mi">4</span><span class="p">.</span><span class="mi">96113432</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">18421053</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">18421053</span> <span class="mi">5</span><span class="p">.</span><span class="mi">09245256</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">21052632</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">21052632</span> <span class="mi">5</span><span class="p">.</span><span class="mi">22377081</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">23684211</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">23684211</span> <span class="mi">5</span><span class="p">.</span><span class="mi">35508905</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">26315789</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">26315789</span> <span class="mi">5</span><span class="p">.</span><span class="mi">48640729</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">28947368</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">28947368</span> <span class="mi">5</span><span class="p">.</span><span class="mi">61772554</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">31578947</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31578947</span> <span class="mi">5</span><span class="p">.</span><span class="mi">74904378</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">34210526</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">34210526</span> <span class="mi">5</span><span class="p">.</span><span class="mi">88036203</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">36842105</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">36842105</span> <span class="mi">6</span><span class="p">.</span><span class="mi">01168027</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">39473684</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">39473684</span> <span class="mi">6</span><span class="p">.</span><span class="mi">14299852</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">42105263</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">42105263</span> <span class="mi">6</span><span class="p">.</span><span class="mi">27431676</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">44736842</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">44736842</span> <span class="mi">6</span><span class="p">.</span><span class="mi">40563501</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">47368421</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">47368421</span> <span class="mi">6</span><span class="p">.</span><span class="mi">53695325</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">00000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">6</span><span class="p">.</span><span class="mi">66827150</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">04166667</span> <span class="mi">0</span><span class="p">.</span><span class="mi">54166667</span> <span class="mi">6</span><span class="p">.</span><span class="mi">81529353</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">08333333</span> <span class="mi">0</span><span class="p">.</span><span class="mi">58333333</span> <span class="mi">6</span><span class="p">.</span><span class="mi">96231556</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">12500000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">62500000</span> <span class="mi">7</span><span class="p">.</span><span class="mi">10933760</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">16666667</span> <span class="mi">0</span><span class="p">.</span><span class="mi">66666667</span> <span class="mi">7</span><span class="p">.</span><span class="mi">25635963</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">20833333</span> <span class="mi">0</span><span class="p">.</span><span class="mi">70833333</span> <span class="mi">7</span><span class="p">.</span><span class="mi">40338166</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">50000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">25000000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">75000000</span> <span class="mi">7</span><span class="p">.</span><span class="mi">55040370</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">46875000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">28125000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">75000000</span> <span class="mi">7</span><span class="p">.</span><span class="mi">66067022</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">43750000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">31250000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">75000000</span> <span class="mi">7</span><span class="p">.</span><span class="mi">77093675</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">40625000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">34375000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">75000000</span> <span class="mi">7</span><span class="p">.</span><span class="mi">88120327</span>
<span class="mi">0</span><span class="p">.</span><span class="mi">37500000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">37500000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">75000000</span> <span class="mi">7</span><span class="p">.</span><span class="mi">99146980</span>
</pre></div>


<p>There are several notable difference with the input file
as compared to the SCF input. The first one is that we have
used <code>calculation = 'bands'</code>.
The next, and probably the most trickiest part, is to choose the k-point
path. Usually, a band structure of a solid is plotted along the k-point
path. This k-point path is made by connecting several high-symmetry points
in the first Brilliouin zone. In the first example, I want to choose the k-point
path which is similar to the one used in this Figure:
[http://www.bandstructure.jp/Table/BAND/band_png/si_lda_5125.ps.png].</p>
<p>In several DFT package, we can simply define k-point path by specifying the
high-symmetry points and number of points to be sampled along each these
points. However (as far as I know), PWSCF does not have this feature, so,
we have to generate our k-point path by ourself. Fortunately, we can use
ASE to help us to generate this k-point path. An example of the script
I used to generate this k-point path is listed below.
This script will generate k-points path along
W-L-<span class="math">\(\Gamma\)</span>-X-W-K.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">ase.dft.kpoints</span> <span class="kn">import</span> <span class="o">*</span>
<span class="kn">from</span> <span class="nn">ase.units</span> <span class="kn">import</span> <span class="n">Bohr</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="c1"># Any lattice parameter should work, the important ones are the</span>
<span class="c1"># lattice vectors v1, v2, and v3. In this case we used the definition</span>
<span class="c1"># of FCC lattice vectors used in PWSCF.</span>
<span class="n">alat</span> <span class="o">=</span> <span class="mf">10.20</span><span class="o">*</span><span class="n">Bohr</span>
<span class="n">v1</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">v2</span> <span class="o">=</span> <span class="p">[</span> <span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
<span class="n">v3</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">cell</span> <span class="o">=</span> <span class="mf">0.5</span><span class="o">*</span><span class="n">alat</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[</span><span class="n">v1</span><span class="p">,</span> <span class="n">v2</span><span class="p">,</span> <span class="n">v3</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>


<span class="c1"># Number of total k-points in the path</span>
<span class="n">NKPT</span> <span class="o">=</span> <span class="mi">60</span>
<span class="c1"># Use ase.dft module for obtaining k-points along high symmetry directions</span>
<span class="n">points</span> <span class="o">=</span> <span class="n">ibz_points</span><span class="p">[</span><span class="s2">&quot;fcc&quot;</span><span class="p">]</span>
<span class="n">W</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span>
<span class="n">L</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="s2">&quot;L&quot;</span><span class="p">]</span>
<span class="n">G</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="s2">&quot;Gamma&quot;</span><span class="p">]</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="s2">&quot;X&quot;</span><span class="p">]</span>
<span class="n">K</span> <span class="o">=</span> <span class="n">points</span><span class="p">[</span><span class="s2">&quot;K&quot;</span><span class="p">]</span>
<span class="n">kpts</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">Xkpt</span> <span class="o">=</span> <span class="n">get_bandpath</span><span class="p">([</span><span class="n">W</span><span class="p">,</span> <span class="n">L</span><span class="p">,</span> <span class="n">G</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">W</span><span class="p">,</span> <span class="n">K</span><span class="p">],</span> <span class="n">cell</span><span class="p">,</span> <span class="n">npoints</span><span class="o">=</span><span class="n">NKPT</span><span class="p">)</span>

<span class="c1"># Write kpts in the format understood by PWSCF</span>
<span class="c1"># The weights of the k-points are not used, so they can take any value.</span>
<span class="c1"># In this case we set them all to x[ik]</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;K_POINTS crystal</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="se">\n</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">NKPT</span><span class="p">)</span>
<span class="k">for</span> <span class="n">ik</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NKPT</span><span class="p">):</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">%.8f</span><span class="s1"> </span><span class="si">%.8f</span><span class="s1"> </span><span class="si">%.8f</span><span class="s1"> </span><span class="si">%.8f</span><span class="se">\n</span><span class="s1">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">kpts</span><span class="p">[</span><span class="n">ik</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span><span class="n">kpts</span><span class="p">[</span><span class="n">ik</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span><span class="n">kpts</span><span class="p">[</span><span class="n">ik</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span><span class="n">x</span><span class="p">[</span><span class="n">ik</span><span class="p">]))</span>
</pre></div>


<p>Now, we can run PWSCF code to calculate the band structure.</p>
<div class="highlight"><pre><span></span><span class="n">pw</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">PWINPUT_bands</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">LOG_bands</span>
</pre></div>


<p>In the log file, you should see something similar to this:</p>
<div class="highlight"><pre><span></span>     <span class="k">End</span> <span class="nv">of</span> <span class="nv">band</span> <span class="nv">structure</span> <span class="nv">calculation</span>

          <span class="nv">k</span> <span class="o">=-</span><span class="mi">1</span>.<span class="mi">0000</span> <span class="mi">0</span>.<span class="mi">5000</span> <span class="mi">0</span>.<span class="mi">0000</span> <span class="ss">(</span>   <span class="mi">360</span> <span class="nv">PWs</span><span class="ss">)</span>   <span class="nv">bands</span> <span class="ss">(</span><span class="nv">ev</span><span class="ss">)</span>:

    <span class="o">-</span><span class="mi">1</span>.<span class="mi">4205</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">4205</span>   <span class="mi">2</span>.<span class="mi">2859</span>   <span class="mi">2</span>.<span class="mi">2859</span>  <span class="mi">10</span>.<span class="mi">4873</span>  <span class="mi">10</span>.<span class="mi">4873</span>  <span class="mi">11</span>.<span class="mi">2922</span>  <span class="mi">11</span>.<span class="mi">2922</span>

          <span class="nv">k</span> <span class="o">=-</span><span class="mi">0</span>.<span class="mi">9375</span> <span class="mi">0</span>.<span class="mi">5000</span> <span class="mi">0</span>.<span class="mi">0625</span> <span class="ss">(</span>   <span class="mi">348</span> <span class="nv">PWs</span><span class="ss">)</span>   <span class="nv">bands</span> <span class="ss">(</span><span class="nv">ev</span><span class="ss">)</span>:

    <span class="o">-</span><span class="mi">1</span>.<span class="mi">8314</span>  <span class="o">-</span><span class="mi">1</span>.<span class="mi">0316</span>   <span class="mi">2</span>.<span class="mi">0471</span>   <span class="mi">2</span>.<span class="mi">6556</span>  <span class="mi">10</span>.<span class="mi">1117</span>  <span class="mi">10</span>.<span class="mi">4752</span>  <span class="mi">11</span>.<span class="mi">3474</span>  <span class="mi">11</span>.<span class="mi">7794</span>

          <span class="nv">k</span> <span class="o">=-</span><span class="mi">0</span>.<span class="mi">8750</span> <span class="mi">0</span>.<span class="mi">5000</span> <span class="mi">0</span>.<span class="mi">1250</span> <span class="ss">(</span>   <span class="mi">342</span> <span class="nv">PWs</span><span class="ss">)</span>   <span class="nv">bands</span> <span class="ss">(</span><span class="nv">ev</span><span class="ss">)</span>:

    <span class="o">-</span><span class="mi">2</span>.<span class="mi">2236</span>  <span class="o">-</span><span class="mi">0</span>.<span class="mi">7384</span>   <span class="mi">2</span>.<span class="mi">0155</span>   <span class="mi">3</span>.<span class="mi">0987</span>   <span class="mi">9</span>.<span class="mi">7584</span>  <span class="mi">10</span>.<span class="mi">0893</span>  <span class="mi">11</span>.<span class="mi">9105</span>  <span class="mi">12</span>.<span class="mi">3847</span>

    ... <span class="o">//</span> <span class="nv">snipped</span>
</pre></div>


<p>This is the data for the band structure that we want. You can use your
favourite scripting language (or tools) to parse the log file and
build the data needed to be plotted as band structure.
However, if you don't want to do that we can use a utility program called
<code>bands.x</code> (also included in the Quantum ESPRESSO) to collect the band structure
data and produce an output which can be directly plotted. Quantum ESPRESSO
also includes an utility program to plot the band structure, however, in this
tutorial I will not use that and used Python to do the plotting.</p>
<p>Before plotting the band structure, let's see how to use <code>bands.x</code> to collect
the band structure data. We need an input file. Let's name this file as
<code>bands.inp</code>. The content of this file is:</p>
<div class="highlight"><pre><span></span><span class="o">&amp;</span><span class="n">BANDS</span>
  <span class="n">outdir</span> <span class="o">=</span> <span class="s1">&#39;./tmp&#39;</span>
<span class="o">/</span>
</pre></div>


<p>You should adjust this to your previous input files (SCF and bands calculation).</p>
<p>Run <code>bands.x</code> with the following command:</p>
<div class="highlight"><pre><span></span><span class="n">bands</span><span class="p">.</span><span class="n">x</span> <span class="o">&lt;</span> <span class="n">bands</span><span class="p">.</span><span class="n">inp</span> <span class="o">|</span> <span class="n">tee</span> <span class="n">LOG_pp_bands</span>
</pre></div>


<p>There are various information (most related to symmetry) in the file <code>LOG_pp_bands</code>.
You will notice that after we run <code>bands.x</code>, several new files will be produced.
The file that we want to use is named <code>bands.out.gnu</code>.
This file consists of two columns. The first column is the coordinate
of k-points which is 'linearized'. The k-point coordinates in 3d dimension
is mapped into distances in 1d. We don't need to fuss about the details about this
in this case because it is already calculated by <code>bands.x</code> for us. 
The second column contains the band energies in eV. The data between
different bands are separated by one space.</p>
<p>In the file <code>LOG_pp_bands</code> we need the coordinates of special k-points.
This information is given in the following lines:</p>
<div class="highlight"><pre><span></span>     <span class="n">high</span><span class="o">-</span><span class="n">symmetry</span> <span class="n">point</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>   <span class="n">x</span> <span class="n">coordinate</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>
     <span class="n">high</span><span class="o">-</span><span class="n">symmetry</span> <span class="n">point</span><span class="p">:</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">5000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5000</span>   <span class="n">x</span> <span class="n">coordinate</span>   <span class="mi">0</span><span class="p">.</span><span class="mi">7071</span>
     <span class="n">high</span><span class="o">-</span><span class="n">symmetry</span> <span class="n">point</span><span class="p">:</span>  <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>   <span class="n">x</span> <span class="n">coordinate</span>   <span class="mi">1</span><span class="p">.</span><span class="mi">5731</span>
     <span class="n">high</span><span class="o">-</span><span class="n">symmetry</span> <span class="n">point</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>   <span class="n">x</span> <span class="n">coordinate</span>   <span class="mi">2</span><span class="p">.</span><span class="mi">5731</span>
     <span class="n">high</span><span class="o">-</span><span class="n">symmetry</span> <span class="n">point</span><span class="p">:</span> <span class="o">-</span><span class="mi">1</span><span class="p">.</span><span class="mi">0000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">5000</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>   <span class="n">x</span> <span class="n">coordinate</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">0731</span>
     <span class="n">high</span><span class="o">-</span><span class="n">symmetry</span> <span class="n">point</span><span class="p">:</span> <span class="o">-</span><span class="mi">0</span><span class="p">.</span><span class="mi">7500</span> <span class="mi">0</span><span class="p">.</span><span class="mi">7500</span> <span class="mi">0</span><span class="p">.</span><span class="mi">0000</span>   <span class="n">x</span> <span class="n">coordinate</span>   <span class="mi">3</span><span class="p">.</span><span class="mi">4267</span>
</pre></div>


<p>This is the coordinate of high-symmetry points that we specified when
we are generating the k-points path, i.e.:
W-L-G-X-W-K.</p>
<p>The script below can be used to plot the band structure data in the file
<code>bands.out.gnu</code>.</p>
<div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="kn">as</span> <span class="nn">plt</span>

<span class="n">NBANDS</span>   <span class="o">=</span> <span class="mi">8</span>
<span class="n">NKPOINTS</span> <span class="o">=</span> <span class="mi">60</span>

<span class="n">databands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">loadtxt</span><span class="p">(</span><span class="s2">&quot;bands.out.gnu_v1&quot;</span><span class="p">)</span>

<span class="n">Nocc</span> <span class="o">=</span> <span class="mi">4</span>  <span class="c1"># number of occupied bands</span>
<span class="n">PLOT_SAVE</span> <span class="o">=</span> <span class="s2">&quot;Si_bands_v1.pdf&quot;</span>
<span class="n">FIGSIZE</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>

<span class="c1"># obtained from the output log of bands.x</span>
<span class="n">Xkpt</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0000</span><span class="p">,</span> <span class="mf">0.7071</span><span class="p">,</span> <span class="mf">1.5731</span><span class="p">,</span> <span class="mf">2.5731</span><span class="p">,</span> <span class="mf">3.0731</span><span class="p">,</span> <span class="mf">3.4267</span><span class="p">]</span>
<span class="n">labelX</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="s2">&quot;L&quot;</span><span class="p">,</span> <span class="sa">r</span><span class="s2">&quot;$\Gamma$&quot;</span><span class="p">,</span> <span class="s2">&quot;X&quot;</span><span class="p">,</span> <span class="s2">&quot;W&quot;</span><span class="p">,</span> <span class="s2">&quot;K&quot;</span><span class="p">]</span>

<span class="n">ebands</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">NKPOINTS</span><span class="p">,</span> <span class="n">NBANDS</span><span class="p">)</span> <span class="p">)</span>
<span class="n">kvec</span>   <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">NKPOINTS</span><span class="p">,</span> <span class="n">NBANDS</span><span class="p">)</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">ib</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NBANDS</span><span class="p">):</span>
    <span class="n">idx1</span> <span class="o">=</span> <span class="p">(</span><span class="n">ib</span><span class="p">)</span><span class="o">*</span><span class="n">NKPOINTS</span>
    <span class="n">idx2</span> <span class="o">=</span> <span class="p">(</span><span class="n">ib</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">NKPOINTS</span>
    <span class="n">ebands</span><span class="p">[:,</span><span class="n">ib</span><span class="p">]</span> <span class="o">=</span> <span class="n">databands</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">kvec</span><span class="p">[:,</span><span class="n">ib</span><span class="p">]</span>   <span class="o">=</span> <span class="n">databands</span><span class="p">[</span><span class="n">idx1</span><span class="p">:</span><span class="n">idx2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">Efermi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">max</span><span class="p">(</span> <span class="n">ebands</span><span class="p">[:,</span><span class="n">Nocc</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>
<span class="n">ebands</span><span class="p">[:,:]</span> <span class="o">=</span> <span class="n">ebands</span><span class="p">[:,:]</span> <span class="o">-</span> <span class="n">Efermi</span>

<span class="n">Emin</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">min</span><span class="p">(</span><span class="n">ebands</span><span class="p">)</span>
<span class="n">Emax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="kp">max</span><span class="p">(</span><span class="n">ebands</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">FIGSIZE</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
<span class="k">for</span> <span class="n">ib</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">NBANDS</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span> <span class="n">kvec</span><span class="p">[:,</span><span class="n">ib</span><span class="p">],</span> <span class="n">ebands</span><span class="p">[:,</span><span class="n">ib</span><span class="p">]</span> <span class="p">)</span>

<span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">Xkpt</span><span class="p">:</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">],</span> <span class="p">[</span><span class="n">Emin</span><span class="p">,</span> <span class="n">Emax</span><span class="p">],</span> <span class="s2">&quot;k-&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">Xkpt</span><span class="p">,</span> <span class="n">labelX</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">Xkpt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;k--&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span> <span class="n">Emin</span><span class="p">,</span> <span class="n">Emax</span> <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span> <span class="mi">0</span><span class="p">,</span> <span class="n">Xkpt</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">&quot;k vector&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Energy (eV)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Band structure of Si&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">PLOT_SAVE</span><span class="p">)</span>
</pre></div>


<p>This the the result:
<figure>
  <img src="/posts/images/qe_Si_fcc_bands/Si_bands_v1.png"
       width="100%" height="100%">
</figure></p>
<p>As exercise you may want to repeat the procedure for different k-points path
like in the following figures.</p>
<figure>
  <img src="/posts/images/qe_Si_fcc_bands/Si_bands_v2.png"
       width="100%" height="100%">
</figure>

<figure>
  <img src="/posts/images/qe_Si_fcc_bands/Si_bands_v3.png"
       width="100%" height="100%">
</figure>

<p>For more information about k-points path you can read the following:</p>
<p>[https://wiki.fysik.dtu.dk/ase/ase/dft/kpoints.html#special-points-in-the-brillouin-zone)].</p>
<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var align = "center",
        indent = "0em",
        linebreak = "false";

    if (false) {
        align = (screen.width < 768) ? "left" : align;
        indent = (screen.width < 768) ? "0em" : indent;
        linebreak = (screen.width < 768) ? 'true' : linebreak;
    }

    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.3/latest.js?config=TeX-AMS-MML_HTMLorMML';

    var configscript = document.createElement('script');
    configscript.type = 'text/x-mathjax-config';
    configscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'none' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: '"+ align +"'," +
        "    displayIndent: '"+ indent +"'," +
        "    showMathMenu: true," +
        "    messageStyle: 'normal'," +
        "    tex2jax: { " +
        "        inlineMath: [ ['\\\\(','\\\\)'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        availableFonts: ['STIX', 'TeX']," +
        "        preferredFont: 'STIX'," +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'inherit ! important'} }," +
        "        linebreaks: { automatic: "+ linebreak +", width: '90% container' }," +
        "    }, " +
        "}); " +
        "if ('default' !== 'default') {" +
            "MathJax.Hub.Register.StartupHook('HTML-CSS Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax['HTML-CSS'].FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
            "MathJax.Hub.Register.StartupHook('SVG Jax Ready',function () {" +
                "var VARIANT = MathJax.OutputJax.SVG.FONTDATA.VARIANT;" +
                "VARIANT['normal'].fonts.unshift('MathJax_default');" +
                "VARIANT['bold'].fonts.unshift('MathJax_default-bold');" +
                "VARIANT['italic'].fonts.unshift('MathJax_default-italic');" +
                "VARIANT['-tex-mathit'].fonts.unshift('MathJax_default-italic');" +
            "});" +
        "}";

    (document.body || document.getElementsByTagName('head')[0]).appendChild(configscript);
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    </div><!-- /.entry-content -->

  </article>
</section>
        <section id="extras" class="body">
                <div class="blogroll">
                        <h2>links</h2>
                        <ul>
                            <li><a href="https://itb.ac.id/">ITB</a></li>
                            <li><a href="http://python.org/">Teknik Fisika ITB</a></li>
                        </ul>
                </div><!-- /.blogroll -->
        </section><!-- /#extras -->

        <footer id="contentinfo" class="body">
                <address id="about" class="vcard body">
                Proudly powered by <a href="http://getpelican.com/">Pelican</a>, which takes great advantage of <a href="http://python.org">Python</a>.
                </address><!-- /#about -->

                <p>The theme is by <a href="http://coding.smashingmagazine.com/2009/08/04/designing-a-html-5-layout-from-scratch/">Smashing Magazine</a>, thanks!</p>
        </footer><!-- /#contentinfo -->

</body>
</html>